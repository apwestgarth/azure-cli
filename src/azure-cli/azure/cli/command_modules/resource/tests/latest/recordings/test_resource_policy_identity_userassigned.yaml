interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - identity create
      Connection:
      - keep-alive
      ParameterSetName:
      - -g -n --tags
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policy_identity_userassigned000001?api-version=2024-11-01
  response:
    body:
      string: '{"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","name":"cli_test_policy_identity_userassigned000001","type":"Microsoft.Resources/resourceGroups","location":"westus","tags":{"product":"azurecli","cause":"automation","test":"test_resource_policy_identity_userassigned","date":"2026-01-22T00:30:59Z","module":"resource"},"properties":{"provisioningState":"Succeeded"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '436'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:00 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: 08CD52E14DAE440DAEFA62447A7887C1 Ref B: MWH011020809040 Ref C: 2026-01-22T00:31:00Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"tags": {"tag1": "d1"}, "location": "westus"}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - identity create
      Connection:
      - keep-alive
      Content-Length:
      - '46'
      Content-Type:
      - application/json
      ParameterSetName:
      - -g -n --tags
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi?api-version=2024-11-30
  response:
    body:
      string: '{"location":"westus","tags":{"tag1":"d1","test1":"<alert>tag1value<alert>"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi","name":"policyCliTestMsi","type":"Microsoft.ManagedIdentity/userAssignedIdentities","properties":{"isolationScope":"Regional","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '550'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:02 GMT
      expires:
      - '-1'
      location:
      - /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/ec6312f5-9a72-4be5-858b-04bb9b24a620
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '11999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '799'
      x-msedge-ref:
      - 'Ref A: 9BD35031E6044EFF8DF1844A8E5C936C Ref B: CO6AA3150217051 Ref C: 2026-01-22T00:31:01Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy definition show
      Connection:
      - keep-alive
      ParameterSetName:
      - --name
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2024-05-01
  response:
    body:
      string: '{"properties":{"displayName":"Audit VMs that do not use managed disks","policyType":"BuiltIn","mode":"All","description":"This
        policy audits VMs that do not use managed disks","metadata":{"version":"1.0.0","category":"Compute"},"version":"1.0.0","parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}},"versions":["1.0.0"]},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a4d"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '954'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:03 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - ''
      x-msedge-ref:
      - 'Ref A: A4CF3F4603174697A5C4097AEFD0DA70 Ref B: MWH011020809023 Ref C: 2026-01-22T00:31:03Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"identity": {"userAssignedIdentities": {"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":
      {}}, "type": "UserAssigned"}, "location": "westus", "properties": {"enforcementMode":
      "DoNotEnforce", "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment create
      Connection:
      - keep-alive
      Content-Length:
      - '448'
      Content-Type:
      - application/json
      ParameterSetName:
      - --policy -n -g --location --mi-user-assigned --enforcement-mode
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":{"principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":null,"updatedOn":null},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:03.67795Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1360'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:04 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/f6850f5a-7449-42e4-ada9-f0564912de01
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '11999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '799'
      x-msedge-ref:
      - 'Ref A: 4EDE18F909944E4AB36D6A68424C2658 Ref B: CO6AA3150220039 Ref C: 2026-01-22T00:31:03Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":{"principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":null,"updatedOn":null},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:03.67795Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1360'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:04 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/02ceb593-1f1d-4640-888a-909937426c2e
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: D4FD53A9872D49859623B775365D77B9 Ref B: CO6AA3150218037 Ref C: 2026-01-22T00:31:04Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment update
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g --description
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":{"principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":null,"updatedOn":null},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:03.67795Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1360'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:04 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/f27c585b-d672-40b2-9592-e57674ecc763
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: DC5F7A6ADE3C45489F7FFD5D967F9DA8 Ref B: CO6AA3150219019 Ref C: 2026-01-22T00:31:05Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"identity": {"type": "UserAssigned", "userAssignedIdentities": {"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":
      {}}}, "location": "westus", "properties": {"definitionVersion": "1.*.*", "description":
      "New description", "enforcementMode": "DoNotEnforce", "metadata": {"createdBy":
      "3d826307-2481-45a0-a271-bcf9333f914a", "createdOn": "2026-01-22T00:31:04.4434731Z",
      "updatedBy": null, "updatedOn": null}, "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment update
      Connection:
      - keep-alive
      Content-Length:
      - '662'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -g --description
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":{"principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:06.0631371Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:05.6177023Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1454'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:06 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus2/6f400946-d56a-4ccd-9616-578c20603630
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '11999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '799'
      x-msedge-ref:
      - 'Ref A: B52775250D314F748A823ABE0574C93F Ref B: MWH011020806062 Ref C: 2026-01-22T00:31:05Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g --user-assigned
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":{"principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:06.0631371Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:05.6177023Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1454'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:06 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/5462f04a-c82f-4282-9435-21a697691a41
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: 14D56B741E414B48A2492D58852886B2 Ref B: CO6AA3150217027 Ref C: 2026-01-22T00:31:06Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"identity": {"type": "None"}, "location": "westus", "properties": {"definitionVersion":
      "1.*.*", "description": "New description", "enforcementMode": "DoNotEnforce",
      "metadata": {"createdBy": "3d826307-2481-45a0-a271-bcf9333f914a", "createdOn":
      "2026-01-22T00:31:04.4434731Z", "updatedBy": "3d826307-2481-45a0-a271-bcf9333f914a",
      "updatedOn": "2026-01-22T00:31:06.0631371Z"}, "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity remove
      Connection:
      - keep-alive
      Content-Length:
      - '492'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -g --user-assigned
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"None"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:06.9461854Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:06.9233623Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1125'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/f3aba400-edcd-45e9-afed-ff81e4f7e67d
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '11999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '799'
      x-msedge-ref:
      - 'Ref A: 40BD9ADAB35C4967848479C028584D16 Ref B: CO6AA3150220021 Ref C: 2026-01-22T00:31:06Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"None"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:06.9461854Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:06.9233623Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1125'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/31a4f6b9-e22a-4fff-802d-011674c356cc
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: B21393D055A2488097E4108B56B600FA Ref B: MWH011020808023 Ref C: 2026-01-22T00:31:07Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity assign
      Connection:
      - keep-alive
      ParameterSetName:
      - --user-assigned -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"None"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:06.9461854Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:06.9233623Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1125'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/ec95dc93-db02-4929-a5be-77fcd416957e
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: 243D396CBFDE48C3AA21818FA515E8B3 Ref B: MWH011020806052 Ref C: 2026-01-22T00:31:07Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"identity": {"userAssignedIdentities": {"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":
      {}}, "type": "UserAssigned"}, "location": "westus", "properties": {"definitionVersion":
      "1.*.*", "description": "New description", "enforcementMode": "DoNotEnforce",
      "metadata": {"createdBy": "3d826307-2481-45a0-a271-bcf9333f914a", "createdOn":
      "2026-01-22T00:31:04.4434731Z", "updatedBy": "3d826307-2481-45a0-a271-bcf9333f914a",
      "updatedOn": "2026-01-22T00:31:06.9461854Z"}, "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity assign
      Connection:
      - keep-alive
      Content-Length:
      - '722'
      Content-Type:
      - application/json
      ParameterSetName:
      - --user-assigned -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":{"principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:08.5912382Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:08.180448Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1453'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/38bc9b71-a86d-4334-9d5d-80e97107bfd4
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '11999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '799'
      x-msedge-ref:
      - 'Ref A: 8FCB2D60E8C14C50887D22DC08FD43C7 Ref B: CO6AA3150218049 Ref C: 2026-01-22T00:31:07Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":{"principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:08.5912382Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:08.180448Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1453'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/ec5f383e-070b-4475-92f4-2e357248e43e
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: BEE8BC09312141B78435EAF46E6F14E1 Ref B: MWH011020808025 Ref C: 2026-01-22T00:31:09Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g --user-assigned
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"UserAssigned","userAssignedIdentities":{"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.ManagedIdentity/userAssignedIdentities/policyCliTestMsi":{"principalId":"b8fd29e1-f400-46ad-8959-04d06b5da424","clientId":"e9e6ca4a-14b2-4893-b215-bcbf6890876f"}}},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:08.5912382Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:08.180448Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1453'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/9b70c3f1-596d-46a3-beb1-a5de01aa8544
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: 4FA2EC543C1D45C4A86B7E049BF0F818 Ref B: MWH011020806029 Ref C: 2026-01-22T00:31:09Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"identity": {"type": "None"}, "location": "westus", "properties": {"definitionVersion":
      "1.*.*", "description": "New description", "enforcementMode": "DoNotEnforce",
      "metadata": {"createdBy": "3d826307-2481-45a0-a271-bcf9333f914a", "createdOn":
      "2026-01-22T00:31:04.4434731Z", "updatedBy": "3d826307-2481-45a0-a271-bcf9333f914a",
      "updatedOn": "2026-01-22T00:31:08.5912382Z"}, "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity remove
      Connection:
      - keep-alive
      Content-Length:
      - '492'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -g --user-assigned
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"None"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:09.5689435Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:09.481559Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1124'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/2c404c07-835d-421e-8bb7-31db9d371818
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '11999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '799'
      x-msedge-ref:
      - 'Ref A: 0084686A51D6405DABAC95D1AC68D9FE Ref B: CO6AA3150219009 Ref C: 2026-01-22T00:31:09Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity assign
      Connection:
      - keep-alive
      ParameterSetName:
      - --system-assigned -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"None"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:09.5689435Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:09.481559Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1124'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/06f336ce-9277-4307-ac1a-32adbd25ccd8
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: 93D4C103E74D4B6593DD30CAFEB2F9C4 Ref B: MWH011020809052 Ref C: 2026-01-22T00:31:10Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"identity": {"type": "SystemAssigned"}, "location": "westus", "properties":
      {"definitionVersion": "1.*.*", "description": "New description", "enforcementMode":
      "DoNotEnforce", "metadata": {"createdBy": "3d826307-2481-45a0-a271-bcf9333f914a",
      "createdOn": "2026-01-22T00:31:04.4434731Z", "updatedBy": "3d826307-2481-45a0-a271-bcf9333f914a",
      "updatedOn": "2026-01-22T00:31:09.5689435Z"}, "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity assign
      Connection:
      - keep-alive
      Content-Length:
      - '502'
      Content-Type:
      - application/json
      ParameterSetName:
      - --system-assigned -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"principalId":"2f915921-4622-4c9d-b20f-7e1b8db23b02","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:11.5226838Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:10.5099728Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1238'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:11 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/bd9a03ce-2e84-4ac6-a394-2b3818280ee0
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '11999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '799'
      x-msedge-ref:
      - 'Ref A: FFCEB33223FF4D23BFF728839CE6F7C9 Ref B: CO6AA3150219035 Ref C: 2026-01-22T00:31:10Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment show
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"principalId":"2f915921-4622-4c9d-b20f-7e1b8db23b02","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:11.5226838Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:10.5099728Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1238'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:11 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/3cd9d69a-abe0-44a0-823d-0b34d69f7262
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: 0D3233685079404B91FE9BB087E63606 Ref B: CO6AA3150220031 Ref C: 2026-01-22T00:31:11Z'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity remove
      Connection:
      - keep-alive
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"principalId":"2f915921-4622-4c9d-b20f-7e1b8db23b02","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:11.5226838Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:10.5099728Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1238'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:12 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/65e4445b-e961-446d-91f0-d2b01e0c7f86
      x-ms-ratelimit-remaining-subscription-global-reads:
      - '16499'
      x-msedge-ref:
      - 'Ref A: 6A2D5E5576434CDB8169BFF25A7DDDE3 Ref B: MWH011020807042 Ref C: 2026-01-22T00:31:12Z'
    status:
      code: 200
      message: OK
- request:
    body: '{"identity": {"type": "None"}, "location": "westus", "properties": {"definitionVersion":
      "1.*.*", "description": "New description", "enforcementMode": "DoNotEnforce",
      "metadata": {"createdBy": "3d826307-2481-45a0-a271-bcf9333f914a", "createdOn":
      "2026-01-22T00:31:04.4434731Z", "updatedBy": "3d826307-2481-45a0-a271-bcf9333f914a",
      "updatedOn": "2026-01-22T00:31:11.5226838Z"}, "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d"}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment identity remove
      Connection:
      - keep-alive
      Content-Length:
      - '492'
      Content-Type:
      - application/json
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"None"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:13.7756502Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:12.6181774Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1125'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:13 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/5ae2f87d-a08b-481a-b482-bfb3e10bd5f3
      x-ms-ratelimit-remaining-subscription-global-writes:
      - '11999'
      x-ms-ratelimit-remaining-subscription-writes:
      - '799'
      x-msedge-ref:
      - 'Ref A: 51B1DE64A4D94F8E9CACAA199E55DF94 Ref B: CO6AA3150219051 Ref C: 2026-01-22T00:31:12Z'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      CommandName:
      - policy assignment delete
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      ParameterSetName:
      - -n -g
      User-Agent:
      - AZURECLI/2.82.0 azsdk-python-core/1.38.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002?api-version=2024-05-01
  response:
    body:
      string: '{"identity":{"type":"None"},"properties":{"policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","definitionVersion":"1.*.*","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001","description":"New
        description","metadata":{"createdBy":"3d826307-2481-45a0-a271-bcf9333f914a","createdOn":"2026-01-22T00:31:04.4434731Z","updatedBy":"3d826307-2481-45a0-a271-bcf9333f914a","updatedOn":"2026-01-22T00:31:13.7756502Z"},"enforcementMode":"DoNotEnforce"},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/cli_test_policy_identity_userassigned000001/providers/Microsoft.Authorization/policyAssignments/azurecli-test-assignment000002","type":"Microsoft.Authorization/policyAssignments","name":"azurecli-test-assignment000002","location":"westus","systemData":{"createdBy":"cstack@ntdev.microsoft.com","createdByType":"User","createdAt":"2026-01-22T00:31:03.67795Z","lastModifiedBy":"cstack@ntdev.microsoft.com","lastModifiedByType":"User","lastModifiedAt":"2026-01-22T00:31:12.6181774Z"}}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '1125'
      content-type:
      - application/json; charset=utf-8
      date:
      - Thu, 22 Jan 2026 00:31:13 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-cache:
      - CONFIG_NOCACHE
      x-content-type-options:
      - nosniff
      x-ms-operation-identifier:
      - tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47,objectId=3d826307-2481-45a0-a271-bcf9333f914a/westus/e29f0af6-51f4-4bb2-b56b-ac07f514e579
      x-ms-ratelimit-remaining-subscription-deletes:
      - '799'
      x-ms-ratelimit-remaining-subscription-global-deletes:
      - '11999'
      x-msedge-ref:
      - 'Ref A: C07B89492C704BE7AA9422EB316019CE Ref B: MWH011020806031 Ref C: 2026-01-22T00:31:14Z'
    status:
      code: 200
      message: OK
version: 1
